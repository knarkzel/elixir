<html>
  <head>
    <% include!("head.stpl"); %>
  </head>
  <body>
    <% include!("nav.stpl"); %>
    <main>
      <% if user.is_some() { %>
        <a href="/thread/create">
          <button>Create new thread</button>
        </a>
      <% } else { %>
        <p>You need to login or create a user in order to see threads</p>
      <% } %>
      <div id="threads">
        <% for thread in &threads { %>
          <div class="thread-listing"> 
            <h3><%= thread.email %></h3>
            <blockquote><%= thread.title %></blockquote>
            <p>Published: <%= thread.published.split_whitespace().next().unwrap() %></p>
            <% for category in thread.categories.split(",").map(str::trim).filter(|x| x.len() > 0) { %>
              <a class="category" href="#">#<%= category %></a>
            <% } %>
          </div>
        <% } %>
      </div>
    </main>
  </body>
</html>
